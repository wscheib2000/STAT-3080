---
title: "Project Part 1" 
author: ""
fontsize: 12pt
geometry: margin=1in
urlcolor: black
output: pdf_document
header-includes:
- \usepackage{setspace}
- \onehalfspacing
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, highlight=FALSE)

library(ggplot2)
library(dplyr)
library(tidyverse)
```

```{r, echo=FALSE}
setwd("C:/Users/student/Documents/School/STAT3080/Project")
war <- read.csv("WAR.csv")
```

## Data Description   
  These data are from <https://www.baseball-reference.com/>. They are measurements of Wins Above Average (WAA) by position for each team from each MLB season from 2015 to 2019. Each row represents a certain team from a certain year, so for instance 2015ARI represents he 2015 Arizona Diamondbacks. The variables represent the year, he team, the position or position group referenced, and the WAA value. The data represent a population because they include every team from each of the years examined.  
   
  The data were collected by going to each yearly page on baseball-reference and downloading the appropriate CSV. Then, the data were imported into R and cleaned up. The main problem was that the data were loaded in the csv files without a Team column. Instead, each entry was formatted with the three letter team abbreviation followed by the value, such as ARI-0.6 for a stat in which the Diamondbacks had a value of -0.6. Each column was split into two, a Team column and a Value column. Then, the data frame was reassembled by merging all of the columns together by the Team column. Next, a Year column was added to the beginning of each data frame. Finally, all of the yearly data frames were combined using rbind and the columns were reordered into a more sensible order. Also, the All.P column was recalculated to only include pitching as opposed to the combination of pitching and batting for pitchers.  
   
  Potential issues with the data are that the teams stay relatively similar from year to year, so trends may be attributed to similar players staying on similar teams as opposed to other factors. Also, it is possible that players at a certain position are simply better than players at another.For example, we might just have a great crop of 3rd basemen now in comparison to past years, whereas our current MLB outfielders are subpar. That might be a problem because it might create ungeneralizable results.
  
## Numeric Summary
```{r}
means_df <- filter(war, Position %in% c("Total"))
means <- tapply(means_df$WAA, means_df$Team, mean) %>% sort(decreasing = T) # (2)
plot <- data.frame(Team=names(means), Mean=means) %>% 
  ggplot(aes(x=Team, y=Mean, label=Mean, fill=Mean))
plot + geom_bar(stat = "identity", width = 0.5) + 
  scale_fill_gradient(low="blue", high="red") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title=element_text(face="bold", size=14), 
        axis.title.y=element_text(size=12), 
        axis.title.x=element_text(size=12)) + 
  geom_text(aes(vjust=1.5*(Mean<0)-0.5)) + 
  labs(title="2015-2019 MLB Wins Above Average by Team", y="Mean WAA")
```
  This graph shows that the Houston Astros have the most mean wins above average of any MLB team over the last 5 years, followed by the LA Dodgers. Also, the San Diego Padres have the fewest mean wins above average, followed by the Detroit Tigers. 

## Graphic Summary
```{r}
war$Position <- factor(war$Position,
                       levels = c("SP", "RP", "C", "1B", "2B", "3B", "SS", "LF", 
                                  "CF", "RF", "DH", "PH", "All.P", "Non.P", 
                                  "OF.All", "Total"))
plot1 <- war %>% # (2)
  filter(Position %in% c("All.P", "Non.P")) %>% 
  ggplot(aes(x=Team, y=WAA, fill=Position))
plot1 + geom_boxplot() + facet_wrap(~Position, labeller = labeller(Position = 
    c("All.P" = "Pitchers",
      "Non.P" = "Batters")), ncol = 1) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1), 
        plot.title=element_text(face="bold", size=14), 
        axis.title.y=element_text(size=12), 
        axis.title.x=element_text(size=12)) + 
  labs(title="2015-2019 MLB Wins Above Average by Position", x="Position", 
       y="Wins Above Average") +
  scale_fill_discrete(labels=c("Pitchers", "Batters"))
```
  From this graph, we can see that over the last 5 years, the Washington Nationals' pitchers have consistently had a higher WAA than any other team in the MLB. On the other hand, the Astros' and Dodgers' batters have had a higher WAA in general than those of the other teams, rivaled only by the New York Yankees.


## References
1. Data from <https://www.baseball-reference.com/>
2. Pipe operators <https://r4ds.had.co.nz/pipes.html>
